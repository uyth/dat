CREATE DATABASE treningsdagbok;

CREATE TABLE TRENING (
	trening_id		INT NOT NULL,
	form					INT NOT NULL,
	prestasjon		INT NOT NULL,
	Dato					DATE NOT NULL,
	Tid 					DATETIME NOT NULL,
	Notat 				VARCHAR(200) NOT NULL,
	CONSTRAINT TRENINGSØKT_PK PRIMARY KEY (ØktID)
);

CREATE TABLE ØVELSE (
	ØvelseID	INT NOT NULL,
	Navn		VARCHAR(30) NOT NULL,
	Beskrivelse	VARCHAR(200) NOT NULL,
  KanErstatteID INT NOT NULL,
  CONSTRAINT ØVELSEID_PK PRIMARY KEY (ØvelseID),
  CONSTRAINT FOREIGN KEY (KanErstatteID) REFERENCES ØVELSE.ØvelseID
								ON UPDATE CASCADE
                ON DELETE CASCADE
);

CREATE TABLE STYRKE (
	ØvelseID	INT NOT NULL,
	Sett		INT NOT NULL,
	Repitisjon	INT NOT NULL,
	Belastning	INT NOT NULL,
	CONSTRAINT STYRKE_PK PRIMARY KEY (ØvelseID),
	CONSTRAINT STYRKE_FK FOREIGN KEY (ØvelseID) REFERENCES ØVELSE.ØvelseID
								ON UPDATE CASCADE
								ON DELETE CASCADE
);


CREATE TABLE KONDISJON (
	ØvelseID	INT NOT NULL,
	Sett		INT NOT NULL,
	Repitisjon	INT NOT NULL,
	Belastning	INT NOT NULL,
	CONSTRAINT STYRKE_PK PRIMARY KEY (ØvelseID),
	CONSTRAINT STYRKE_FK FOREIGN KEY (ØvelseID) REFERENCES ØVELSE.ØvelseID
								ON UPDATE CASCADE
								ON DELETE CASCADE
);

CREATE TABLE UTHOLDENHET (
	ØvelseID INT NOT NULL,
    Lengde FLOAT NOT NULL,
    SekvensID INT NOT NULL,
    CONSTRAINT UTHOLDENHET_PK PRIMARY KEY (ØvelseID),
    CONSTRAINT UTHOLDENHET_FK FOREIGN KEY (SekvensID) REFERENCES SEKVENS.SekvensID
							ON UPDATE CASCADE
              ON DELETE CASCADE
);

CREATE TABLE ØKTPLAN (
	ØktplanID 	INT NOT NULL,
	Mål			VARCHAR(30),
	CONSTRAINT ØKTPLAN_PK PRIMARY KEY (ØKTPLANID)
);


CREATE TABLE RESULTAT (
	ResultatID 			INT NOT NULL,
    Belastning 		INT,
    Repetisjon 		INT,
    Sett 					INT,
    Lengde 				FLOAT,
    Dato 					DATE NOT NULL,
    Øvelse 				VARCHAR(15) NOT NULL,
	CONSTRAINT RESULTAT_PK PRIMARY KEY (ResultatID)
);

CREATE TABLE RESULTATØKTPLAN (
	ØktplanID 	INT NOT NULL,
    ResultatID 	INT NOT NULL,
    CONSTRAINT PRIMARY KEY (ØktplanID, ResultatID),
    CONSTRAINT ØKTPLANID_FK FOREIGN KEY (ØktplanID) REFERENCES ØKTPLAN.ØktplanID
						ON UPDATE CASCADE
                        ON DELETE CASCADE,
    CONSTRAINT RESULTAT_FK FOREIGN KEY (ResultatID) REFERENCES RESULTAT.ResultatID
						ON UPDATE CASCADE
                        ON DELETE CASCADE
);

CREATE TABLE RESULTATER (
	ResultatID 		INT NOT NULL,
    ResultatLoggID 	INT NOT NULL,
    CONSTRAINT PRIMARY KEY (ResultatID, ResultatLoggID),
    CONSTRAINT RESULTATID_FK FOREIGN KEY (ResultatID) REFERENCES RESULTAT.ResultatID
							ON UPDATE CASCADE
              ON DELETE CASCADE,
	CONSTRAINT RESULTATLOGGID_FK FOREIGN KEY (ResultatLoggID) REFERENCES RESULTATLOGGID.ResultatLoggID
							ON UPDATE CASCADE
              ON DELETE CASCADE
);


CREATE TABLE INNEHOLDERØVELSE (
	ØktplanID 	INT NOT NULL,
    ØvelseID 	INT NOT NULL,
    CONSTRAINT PRIMARY KEY (ØktplanID, ØvelseID),
    CONSTRAINT ØKTPLANID_FK FOREIGN KEY (ØktplanID) REFERENCES ØKTPLAN.ØktplanID
						ON UPDATE CASCADE
                        ON DELETE CASCADE,
	CONSTRAINT ØVELSEID_FK FOREIGN KEY (ØktplanID) REFERENCES ØVELSE.ØvelseID
						ON UPDATE CASCADE
                        ON DELETE CASCADE
);


CREATE TABLE RESULTATLOGG (
	ResultatLoggID	INT NOT NULL,
	CONSTRAINT RESULTATLOGGID_PK PRIMARY KEY (ResultatLoggID)
);

CREATE TABLE SEKVENS (
	SekvensID		INT NOT NULL,
	punktID			INT NOT NULL,
	ØvelseID 		INT NOT NULL,
	CONSTRAINT SEKVENS_PK PRIMARY KEY (SekvensID),
    CONSTRAINT ØVELSEID_FK FOREIGN KEY (ØvelseID) REFERENCES UTHOLDENHET.ØvelseID
						ON UPDATE CASCADE
                        ON DELETE CASCADE,
	CONSTRAINT SEKVENS_FK FOREIGN KEY (PunktID) REFERENCES PUNKT.PunktID
						ON UPDATE CASCADE
						ON DELETE CASCADE
);

CREATE TABLE INNEHOLDERPUNKT (
	PunktID			INT NOT NULL,
    SekvensID		INT NOT NULL,
    CONSTRAINT INNEHOLDERPUNKT_PK PRIMARY KEY (PunktID, SekvensID),
    CONSTRAINT INNEHOLDERPUNKT_FK FOREIGN KEY (PunktID) REFERENCES PUNKT.PunktID
						ON UPDATE CASCADE
            ON DELETE CASCADE,
    CONsTRAINT INNEHOLDERPUNKT_FK FOREIGN KEY (SeksvensID) REFERENCES SEKVENS.SekvensID
						ON UPDATE CASCADE
            ON DELETE CASCADE
);

CREATE TABLE PUNKT (
	PunktID			INT NOT NULL,
	Tid					DATETIME NOT NULL,
	Puls				INT NOT NULL,
	Lengdegrad	FLOAT NOT NULL,
	Breddegrad	FLOAT NOT NULL,
	Moh					FLOAT NOT NULL,
	CONSTRAINT PUNKT_PK PRIMARY KEY(PunktID)
);
